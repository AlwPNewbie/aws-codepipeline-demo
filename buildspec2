version: 0.2

phases:
install:
runtime-versions:
nodejs: 12
java: coretto8
commands:
- apt-get update
- apt-get install -y jq
- wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.6.2.2472-linux.zip
- unzip ./sonar-scanner-cli-4.6.2.2472-linux.zip
- export PATH=$PATH:./sonar-scanner-4.6.2.2472-linux/bin/
pre_build:
commands:
- echo $JAVA_HOME
- sonar-scanner -Dsonar.organization=xx -Dsonar.projectKey=xx -Dsonar.sources=src -Dsonar.host.url=https://sonarcloud.io -Dsonar.login=xxxx
- sleep 5
- curl https://sonarcloud.io/api/qualitygates/project_status?projectKey=xxx > analysis.json
- cat analysis.json
